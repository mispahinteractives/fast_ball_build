(()=>{"use strict";class t extends Phaser.Scene{width=null;height=null;handlerScene=null;sceneStopped=!1;constructor(){super({key:"boot"})}init(){}preload(){}create(){this.scene.stop("boot"),this.scene.launch("preload")}}class i extends Phaser.Scene{width=null;height=null;handlerScene=null;sceneStopped=!1;constructor(){super({key:"preload"})}init(){var t=document.createElement("style");document.head.appendChild(t);var i=t.sheet;i.insertRule('@font-face { font-family: "PepsiOwners_Regular"; src: url("fonts/PepsiOwners_Regular.ttf") format("truetype"); }\n',0),i.insertRule('@font-face { font-family: "PepsiOwners_Extended"; src: url("fonts/PepsiOwners_Extended.ttf") format("truetype"); }\n',0),i.insertRule('@font-face { font-family: "UberMoveMedium"; src: url("fonts/UberMoveMedium.otf") format("opentype"); }\n',0)}preload(){this.load.image("bg","assets/bg.png"),this.load.image("bg3","assets/bg3.png"),this.load.image("ball","assets/ball.png"),this.load.image("square","assets/square.png"),this.load.atlas("sheet","assets/sheet.png","assets/sheet.json"),this.load.script("webfont","lib/webfont.js"),this.load.plugin("rextagtextplugin","lib/rextagtextplugin.min.js",!0),this.load.audio("bgm_loop","sounds/bgm_loop.mp3"),this.load.audio("bonus","sounds/bonus.mp3"),this.load.audio("bounce","sounds/bounce.mp3"),this.load.audio("fail","sounds/fail.mp3"),this.load.audio("win","sounds/win.mp3"),this.canvasWidth=this.sys.game.canvas.width,this.canvasHeight=this.sys.game.canvas.height,this.width=this.game.screenBaseSize.width,this.height=this.game.screenBaseSize.height,this.sceneStopped=!1,this.load.on("progress",(t=>{})),this.load.on("complete",(()=>{}))}create(){this.firstTime=!1;let t=this;WebFont.load({custom:{families:["PepsiOwners_Regular","PepsiOwners_Extended","UberMoveMedium"]},active:function(){t.scene.stop("preload"),t.scene.launch("GameScene")}})}}class e extends Phaser.GameObjects.Container{constructor(t,i,e,s,a){super(t),this.scene=t,this.x=i,this.y=e,this.gameScene=s,this.dimensions=a,this.scene.add.existing(this),this.init()}init(){this.countValue=0,this.graphicsGrp=this.scene.add.container(0,0),this.add(this.graphicsGrp),this.graphics=this.scene.make.graphics().fillStyle(1315860,1).fillRect(this.dimensions.leftOffset,this.dimensions.topOffset,this.dimensions.actualWidth,this.dimensions.actualHeight),this.graphicsGrp.add(this.graphics),this.bg=this.scene.add.sprite(0,0,"bg3").setOrigin(.5),this.add(this.bg),this.frame=this.scene.add.graphics(),this.frame.lineStyle(5,0),this.frame.strokeRoundedRect(-235,-450,470,900,50),this.add(this.frame),this.line=this.scene.add.sprite(0,100,"sheet","outline").setOrigin(.5).setScale(.8),this.add(this.line),this.logo=this.scene.add.sprite(0,-250,"sheet","logo").setOrigin(.5).setScale(.8),this.add(this.logo),this.bestText=this.scene.add.text(0,190,this.scene.text.texts[0].best,{fontFamily:"UberMoveMedium",fontSize:50,fill:"#000000",align:"center"}),this.bestText.setOrigin(.5),this.add(this.bestText),this.scoreText=this.scene.add.text(0,0,this.countValue,{fontFamily:"UberMoveMedium",fontSize:60,fill:"#000000",align:"center"}),this.scoreText.setOrigin(.5),this.add(this.scoreText),this.playBtn=this.scene.add.sprite(0,320,"sheet","play"),this.playBtn.setOrigin(.5),this.playBtn.setScale(.3),this.add(this.playBtn),this.playBtn.setInteractive(),this.playBtn.on("pointerdown",(()=>{this.ctaClick(this.playBtn)})),this.visible=!1,this.userWon=!0}ctaClick(t){this.done||(t.disableInteractive(),this.scene.restart(),this.done=!0,this.scene.time.addEvent({delay:1e4,callback:()=>{this.done=!1,t.setInteractive()}}))}show(){this.visible||(this.visible=!0,this.scene.gamePlay.score<=0?this.scene.sound.play("fail",{volume:1}):(this.scene.sound.play("win",{volume:1}),this.scoreText.setText(this.scene.gamePlay.score)),this.alpha=0,this.logo.alpha=0,this.bestText.alpha=0,this.scoreText.alpha=0,this.playBtn.alpha=0,this.scene.tweens.add({targets:this,alpha:{from:0,to:1},ease:"Linear",duration:200,onComplete:()=>{this.scene.tweens.add({targets:this.logo,alpha:{from:0,to:1},ease:"Back.easeOut",duration:200,onComplete:()=>{this.scene.tweens.add({targets:this.logo,scale:{from:this.logo.scale,to:this.logo.scale+.1},ease:"Linear",duration:700,yoyo:!0,repeat:-1}),this.scene.tweens.add({targets:this.scoreText,alpha:{from:0,to:1},scale:{from:0,to:this.scoreText.scale},ease:"Linear",duration:200,onComplete:()=>{this.scene.tweens.add({targets:this.bestText,alpha:{from:0,to:1},scaleX:{from:0,to:this.bestText.scaleX},ease:"Linear",duration:200,onComplete:()=>{this.scene.tweens.add({targets:this.playBtn,alpha:{from:0,to:1},scale:{from:0,to:this.playBtn.scale},ease:"Linear",duration:200,onComplete:()=>{this.scene.tweens.add({targets:this.playBtn,scale:{from:this.playBtn.scale,to:this.playBtn.scale-.05},ease:"Linear",duration:700,yoyo:!0,repeat:-1})}})}})}})}})}}))}adjust(){this.x=this.dimensions.gameWidth/2,this.y=this.dimensions.gameHeight/2,this.bg.setScale(1);let t=this.dimensions.actualWidth/this.bg.displayWidth,i=this.dimensions.actualHeight/this.bg.displayHeight,e=Math.max(t,i);this.bg.setScale(e),this.bg.x=this.dimensions.gameWidth/2-this.x,this.bg.y=this.dimensions.gameHeight/2-this.y,this.graphics&&this.graphics.destroy(),this.graphics=this.scene.make.graphics().fillStyle(1315860,1).fillRect(this.dimensions.leftOffset-this.x,this.dimensions.topOffset-this.y,this.dimensions.actualWidth,this.dimensions.actualHeight),this.graphicsGrp.add(this.graphics)}hide(){this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:100,onComplete:()=>{this.alpha=1,this.visible=!1}})}}const s={texts:[{best:"Best",play:"Play",intro:"Drag a line, \nthe ball bounces \noff it and moves\n dynamically."}]},a={gameWidth:540,gameHeight:960},h={gameWidth:960,gameHeight:540};class l extends Phaser.GameObjects.Container{constructor(t,i,e,s,a){super(t),this.scene=t,this.dimensions=a,this.x=i,this.y=e,this.gameScene=s,this.scene.add.existing(this),this.collisionCooldown=0,this.init()}init(){this.rectWidth=470,this.rectHeight=900,this.speedMultiplier=4,this.ballVelocityX=0,this.ballVelocityY=3*this.speedMultiplier,this.minX=-this.rectWidth/2,this.maxX=this.rectWidth/2,this.minY=-this.rectHeight/2-48,this.maxY=this.rectHeight/2,this.lineInteracted=!1,this.gameOver=!1,this.score=0,this.rectGraphics=this.scene.add.graphics(),this.rectGraphics.lineStyle(7,0,0),this.rectGraphics.strokeRoundedRect(this.minX,this.minY,this.rectWidth,this.rectHeight,50),this.add(this.rectGraphics),this.scoreText=this.scene.add.text(0,-100,this.score,{fontFamily:"UberMoveMedium",fontSize:300,fill:"#458780",align:"center"}),this.scoreText.setOrigin(.5),this.add(this.scoreText),this.ball=this.scene.add.sprite(0,200,"sheet","ball"),this.ball.setOrigin(.5),this.add(this.ball),this.line=this.scene.add.sprite(0,300,"sheet","line"),this.line.setOrigin(.5),this.add(this.line),this.outline=this.scene.add.sprite(0,350,"sheet","outline"),this.outline.setOrigin(.5),this.add(this.outline),this.line.setInteractive(),this.scene.input.setDraggable(this.line),this.lineInteracted=!1,this.scene.input.on("drag",((t,i,e,s)=>{if(this.scene.firstTouchEvent(this.scene),i===this.line){let t=Phaser.Math.Clamp(e,this.minX+this.line.displayWidth/2,this.maxX-this.line.displayWidth/2);this.line.x=t,this.emitter.visible=!0,this.lineInteracted=!0,this.scene.gamePlay.startGame()}})),this.emitterBallSpeed=100,this.emitter=this.scene.add.particles(0,0,"ball",{lifespan:400,scale:{start:1,end:.6},alpha:{start:.8,end:0},quantity:1,frequency:100,maxParticles:10}),this.emitter.startFollow(this.ball),this.add(this.emitter),this.emitter.visible=!1,this.staticBall=this.scene.add.sprite(-150,-250,"sheet","white"),this.staticBall.setOrigin(.5),this.add(this.staticBall),this.staticBallWidth=this.staticBall.width,this.staticBallHeight=this.staticBall.height,this.visible=!0}startGame(){this.gameStarted=!0,this.visible=!0}update(){if(!this.gameStarted)return;if(this.gameOver)return;if(this.lineInteracted&&0===this.ballVelocityX&&(this.ballVelocityX=2*this.speedMultiplier),this.ball.x+=this.ballVelocityX,this.ball.y+=this.ballVelocityY,this.ball.y+this.ball.displayHeight/2>=this.outline.y+this.outline.displayHeight/2)return void this.showFail();(this.ball.y-this.ball.displayHeight/2<=this.minY||this.ball.y+this.ball.displayHeight/2>=this.maxY)&&(this.ballVelocityY*=-1,this.triggerHitEmitter(this.ball.x,this.ball.y)),(this.ball.x-this.ball.displayWidth/2<=this.minX||this.ball.x+this.ball.displayWidth/2>=this.maxX)&&(this.ballVelocityX*=-1,this.triggerHitEmitter(this.ball.x,this.ball.y));let t=this.scene.time.now;this.checkCollisionWithLine()&&t-this.collisionCooldown>200&&(this.handleLineCollision(),this.collisionCooldown=t);let i=this.ball.x-this.staticBall.x,e=this.ball.y-this.staticBall.y;if(Math.sqrt(i*i+e*e)<this.ball.displayWidth){this.staticBall.destroy(),this.updateScore();let t=Phaser.Math.Between(this.minX+50,this.maxX-50),s=Phaser.Math.Between(this.minY+50,this.maxY-350);this.staticBall=this.scene.add.sprite(t,s,"sheet","white"),this.staticBall.setOrigin(.5),this.add(this.staticBall),this.staticBallWidth=this.staticBall.displayWidth,this.staticBallHeight=this.staticBall.displayHeight;let a=Math.atan2(e,i),h=Math.sqrt(this.ballVelocityX*this.ballVelocityX+this.ballVelocityY*this.ballVelocityY);this.ballVelocityX=Math.cos(a)*h,this.ballVelocityY=Math.sin(a)*h}}handleLineCollision(){0===this.ballVelocityX&&this.startLineMovement(),this.triggerHitEmitter(this.ball.x,this.ball.y),this.ballVelocityY*=-1}checkCollisionWithOutline(){let t=this.ball.x-this.ball.displayWidth/2,i=this.ball.x+this.ball.displayWidth/2,e=this.ball.y-this.ball.displayHeight/2,s=this.ball.y+this.ball.displayHeight/2,a=this.outline.x-this.outline.displayWidth/2,h=this.outline.x+this.outline.displayWidth/2,l=this.outline.y-this.outline.displayHeight/2,n=this.outline.y+this.outline.displayHeight/2;return i>a&&t<h&&s>l&&e<n}checkCollisionWithLine(){let t=this.ball.x-this.ball.displayWidth/2,i=this.ball.x+this.ball.displayWidth/2,e=this.ball.y-this.ball.displayHeight/2,s=this.ball.y+this.ball.displayHeight/2,a=this.line.x-this.line.displayWidth/2,h=this.line.x+this.line.displayWidth/2,l=this.line.y-this.line.displayHeight/2,n=this.line.y+this.line.displayHeight/2;return i>a&&t<h&&s>l&&e<n}startLineMovement(){this.lineMoving||(this.lineMoving=!0,console.log("line moving"),setTimeout((()=>{this.line.y-=3,this.outline.y-=3,this.lineMoving=!1}),200))}updateScore(){this.scene.sound.play("bonus",{volume:.4}),this.score+=1,this.scoreText.setText(this.score)}showFail(){this.triggerHitEmitter(this.ball.x,this.ball.y),this.gameOver=!0,console.log("FAIL! The ball has hit the bottom."),this.ballVelocityX=0,this.ballVelocityY=0,this.emitter&&this.emitter.stop(),setTimeout((()=>{this.scene.cta.show()}),500)}triggerHitEmitter(t,i){this.scene.firstTouchDetected&&this.scene.sound.play("bounce",{volume:1});let e=this.scene.add.particles(t,i,"square",{speed:80,lifespan:600,scale:{start:.8,end:.3},alpha:{start:1,end:.5},quantity:6,frequency:0,maxParticles:6,angle:{min:0,max:360},gravityY:100,collide:!0,bounce:.8});this.add(e)}}Phaser.GameObjects.Container;class n extends Phaser.GameObjects.Container{constructor(t,i,e,s,a){super(t),this.scene=t,this.dimensions=a,this.x=i,this.y=e,this.gameScene=s,this.scene.add.existing(this),this.init()}init(){this.frame=this.scene.add.sprite(-20,0,"sheet","frame"),this.frame.setOrigin(.5),this.frame.setScale(.55),this.add(this.frame),this.frameText=this.scene.add.text(70,-25,this.scene.text.texts[0].intro,{fontFamily:"UberMoveMedium",fontSize:35,fill:"#733706",align:"center"}),this.frameText.setOrigin(.5),this.add(this.frameText),this.play=this.scene.add.text(70,180,this.scene.text.texts[0].play,{fontFamily:"UberMoveMedium",fontSize:45,fill:"#ffffff",align:"center"}),this.play.setOrigin(.5),this.add(this.play),this.visible=!1,this.frame.alpha=0,this.frameText.alpha=0,this.play.alpha=0,this.show()}show(){this.visible||(this.visible=!0,this.scene.tweens.add({targets:this.frame,x:{from:this.frame.x-300,to:this.frame.x},alpha:{from:0,to:1},ease:"Cubic.In",duration:250,onComplete:()=>{this.scene.tweens.add({targets:this.frameText,scale:{from:0,to:this.frameText.scaleX},alpha:{from:0,to:1},ease:"Linear",duration:250}),this.scene.tweens.add({targets:this.play,scale:{from:0,to:this.play.scaleX},alpha:{from:0,to:1},ease:"Linear",duration:250})}}))}hide(){this.visible&&this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:200,onComplete:()=>{this.visible=!1,this.alpha=1}})}adjust(){this.x=this.dimensions.gameWidth/2,this.y=this.dimensions.bottomOffset-230}}let o={};class d extends Phaser.Scene{constructor(){super("GameScene")}preload(){this.levelIndex=0,o.isPortrait!=o.fullWidth<o.fullHeight?this.switchMode(!o.isPortrait):this.switchMode(o.isPortrait);let t=window.devicePixelRatio;o.fullWidth=window.innerWidth*t,o.fullHeight=window.innerHeight*t,this.scale.displaySize.setAspectRatio(o.fullWidth/o.fullHeight),this.scale.refresh(),this.scale.lockOrientation(this.game.orientation)}create(){this.setGameScale(),document.getElementById("loader").style.visibility="hidden",this.text=s,this.superGroup=this.add.container(),this.gameGroup=this.add.container(),this.superGroup.add(this.gameGroup),this.bg=this.add.sprite(0,0,"bg").setOrigin(.5),this.gameGroup.add(this.bg),this.gamePlay=new l(this,0,0,this,o),this.gameGroup.add(this.gamePlay),this.intro=new n(this,0,0,this,o),this.gameGroup.add(this.intro),this.logo=this.add.sprite(0,0,"sheet","logo").setOrigin(.5).setScale(.4),this.gameGroup.add(this.logo),this.cta=new e(this,0,0,this,o),this.gameGroup.add(this.cta),this.gameOver=!1,this.setPositions();try{dapi.addEventListener("adResized",this.gameResized.bind(this))}catch(t){this.scale.on("resize",this.gameResized,this)}this.gameResized(),window.restart&&(this.firstTouchDetected=!1),this.firstTouch()}firstTouch(){this.input.on("pointerdown",this.firstTouchEvent,this)}firstTouchEvent(){this.firstTouchDetected||(this.firstTouchDetected=!0,console.log("First touch detected!"),this.bgm=this.sound.add("bgm_loop",{loop:!0,volume:1}),this.bgm.play(),this.intro.hide())}hideUI(){this.tweens.add({targets:[this.tutorial,this.gamePlay],alpha:0,ease:"Linear",duration:250})}restart(t){window.restart=!0,this.scene.restart()}destroySounds(){this.sound.mute=!this.sound.mute}update(t,i){super.update(),this.gamePlay.update()}setGameScale(){let t=o.fullWidth/o.gameWidth,i=o.fullHeight/o.gameHeight;this.gameScale=t<i?t:i,o.actualWidth=this.game.canvas.width/this.gameScale,o.actualHeight=this.game.canvas.height/this.gameScale,o.leftOffset=-(o.actualWidth-o.gameWidth)/2,o.rightOffset=o.gameWidth-o.leftOffset,o.topOffset=-(o.actualHeight-o.gameHeight)/2,o.bottomOffset=o.gameHeight-o.topOffset}switchMode(t){o.isPortrait=t,o.isLandscape=!t;let i=a;o.isLandscape&&(i=h),o.gameWidth=i.gameWidth,o.gameHeight=i.gameHeight}gameResized(){let t=1;try{if("tiktok"!=`${PLATFORM}`)try{if(mraid){var i=mraid.getScreenSize();mraid.setResizeProperties({width:i.width,height:i.height,offsetX:0,offsetY:0}),mraid.expand()}}catch(t){}}catch(t){}void 0!==window.screen.systemXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.systemXDPI>window.screen.logicalXDPI?t=window.screen.systemXDPI/window.screen.logicalXDPI:void 0!==window.devicePixelRatio&&(t=window.devicePixelRatio);try{let t=dapi.getScreenSize();o.fullWidth=t.width,o.fullHeight=t.height}catch(i){o.fullWidth=Math.ceil(window.innerWidth*t),o.fullHeight=Math.ceil(window.innerHeight*t)}o.ratio=t,this.game.canvas.width===o.fullWidth&&this.game.canvas.height===o.fullHeight||(o.isPortrait!=o.fullWidth<o.fullHeight?this.switchMode(!o.isPortrait):this.switchMode(o.isPortrait),this.game.scale.setGameSize(o.fullWidth,o.fullHeight),this.game.canvas.style.width=o.fullWidth+"px",this.game.canvas.style.height=o.fullHeight+"px",this.game.scale.updateBounds(),this.game.scale.refresh(),this.setGameScale(),this.setPositions())}setPositions(){this.superGroup.scale=this.gameScale,this.gameGroup.x=(this.game.canvas.width/this.gameScale-o.gameWidth)/2,this.gameGroup.y=(this.game.canvas.height/this.gameScale-o.gameHeight)/2,this.bg.setScale(1);let t=o.actualWidth/this.bg.displayWidth,i=o.actualHeight/this.bg.displayHeight,e=Math.max(t,i);this.bg.setScale(e),this.bg.x=o.gameWidth/2,this.bg.y=o.gameHeight/2,this.logo.x=o.gameWidth/2-200,this.logo.y=o.topOffset+80,this.gamePlay.x=o.gameWidth/2,this.gamePlay.y=o.gameHeight/2+50,this.cta.adjust(),this.intro.adjust()}offsetMouse(){return{x:this.game.input.activePointer.worldX*o.actualWidth/o.fullWidth+(o.gameWidth-o.actualWidth)/2,y:this.game.input.activePointer.worldY*o.actualHeight/o.fullHeight+(o.gameHeight-o.actualHeight)/2}}offsetWorld(t){return{x:t.x*o.actualWidth/this.game.width,y:t.y*o.actualHeight/this.game.height}}}const r=window.devicePixelRatio,c={type:Phaser.CANVAS,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,parent:"game",width:540,height:960,antialias:!1},backgroundColor:0,dom:{createContainer:!0},scene:[t,i,d],physics:{default:"matter",matter:{debug:!1}}},g=new Phaser.Game(c);g.debugMode=!0,g.embedded=!1,g.screenBaseSize={width:window.innerWidth*r,height:window.innerHeight*r},g.orientation="portrait"})();